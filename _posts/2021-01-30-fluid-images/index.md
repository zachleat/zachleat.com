---
title: Barebones CSS for Fluid Images
tags:
  - research
tweet: 'https://twitter.com/zachleat/status/1355197710954016769'
---
A few days back [{% twitterImageAvatar "CarolSaysThings" %}CarolSaysThings](https://twitter.com/carolsaysthings) posed what I expected to be a simple question until I started to question what I already knew. Carol had some image markup (generated by [Eleventy Image](https://www.11ty.dev/docs/plugins/image/#use-this-in-your-templates)) and was asking the best way to make the image fluid (match the width of its container). I knew I understood this well enough to use it in my own work but I started to realize that perhaps I _didn‚Äôt_ know this topic well enough to **teach** it so I dove in a little deeper.

**Primary goal:** I want to test `width: 100%` versus `max-width: 100%` and how those interact with `[width][height]` and `srcset` attributes.

<style>
.demo-img-width {
  display: block;
  width: 100%;
  max-width: none;
}
.demo-img-maxwidth {
  display: block;
  max-width: 100%;
}
.demo-img-widthauto {
  width: auto;
}
.demo-container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  padding-top: .5rem;
}
.demo-container > h3,
.demo-container > h4,
.demo-container > p {
  flex-basis: 100%;
}
.demo-container > h3 {
  margin-bottom: 1rem;
}
.demo-container > h3:first-child,
.demo-container > h3 + h4 {
  margin-top: 0;
}
.demo-container > .livedemo {
  margin: .5em 0 0;
}
.demo-container > .livedemo:last-child {
  margin-bottom: 0;
}
</style>
Now, my usual take was to pop some `width: 100%` CSS on that thing and call it a day. `width: 100%` CSS forces the image to fill up the width of the container. This overrides any `[width]` attribute you have set. This has the downside that the image can outgrow it‚Äôs own dimensions and can appear blurry.

_Each case below uses a 200√ó200 image in both a `150px` container (to shrink) and a `300px` container (to grow)._

<div class="livedemo demo-container" data-demo-label="">
  <h3>width: 100%</h3>

  <h4>Without [width][height]</h4>
  <div class="livedemo" data-demo-label="Image > Container" style="width: 150px">
    <img src="./_ignored_yL0QoCVMHj-200.jpeg" alt="The sample Nebula Image from Unsplash on the Eleventy Image docs" class="demo-img-width" eleventy:ignore>
  </div>
  <div class="livedemo" data-demo-label="Container > Image" style="width: 300px">
    <img src="./_ignored_yL0QoCVMHj-200.jpeg" alt="The sample Nebula Image from Unsplash on the Eleventy Image docs" class="demo-img-width" eleventy:ignore>
  </div>

  <h4>Using [width][height]</h4>
  <div class="livedemo" data-demo-label="Image > Container" style="width: 150px">
    <img src="./_ignored_yL0QoCVMHj-200.jpeg" width="200" height="200" loading="lazy" decoding="async" alt="The sample Nebula Image from Unsplash on the Eleventy Image docs" class="demo-img-width" eleventy:ignore>
  </div>
  <div class="livedemo" data-demo-label="Container > Image" style="width: 300px">
    <img src="./_ignored_yL0QoCVMHj-200.jpeg" width="200" height="200" loading="lazy" decoding="async" alt="The sample Nebula Image from Unsplash on the Eleventy Image docs" class="demo-img-width" eleventy:ignore>
  </div>
</div>

The `100%` in `max-width` refers to the container dimensions. Sometimes the `[width]` attribute will be smaller than this container, which means the image will not always be full width. Practically speaking, the image will never grow larger than its own internal or intrinsic dimensions.

Another way to think about this, the image width can range between `0` and `[width]`, depending on the container size.

_Editors note: the above section had a pretty glaring error and was corrected thanks to [@CarolSaysThings](https://twitter.com/CarolSaysThings/), [@HarryMoore2409](https://twitter.com/HarryMoore2409/), and [@nhoizey](https://twitter.com/nhoizey/)! Sorry about that, y‚Äôall._

<div class="livedemo demo-container" data-demo-label="">
  <h3>max-width: 100%</h3>

  <h4>Without [width][height]</h4>
  <div class="livedemo" data-demo-label="Image > Container" style="width: 150px">
    <img src="./_ignored_yL0QoCVMHj-200.jpeg" alt="The sample Nebula Image from Unsplash on the Eleventy Image docs" class="demo-img-maxwidth" eleventy:ignore>
  </div>
  <div class="livedemo" data-demo-label="Container > Image" style="width: 300px">
    <img src="./_ignored_yL0QoCVMHj-200.jpeg" alt="The sample Nebula Image from Unsplash on the Eleventy Image docs" class="demo-img-maxwidth" eleventy:ignore>
  </div>

  <h4>Using [width][height]</h4>
  <div class="livedemo" data-demo-label="Image > Container" style="width: 150px">
    <img src="./_ignored_yL0QoCVMHj-200.jpeg" width="200" height="200" loading="lazy" decoding="async" alt="The sample Nebula Image from Unsplash on the Eleventy Image docs" class="demo-img-maxwidth" eleventy:ignore>
  </div>
  <div class="livedemo" data-demo-label="Container > Image" style="width: 300px">
    <img src="./_ignored_yL0QoCVMHj-200.jpeg" width="200" height="200" loading="lazy" decoding="async" alt="The sample Nebula Image from Unsplash on the Eleventy Image docs" class="demo-img-maxwidth" eleventy:ignore>
  </div>
</div>

Let‚Äôs use `srcset` to add another eligible image width (now 200px and 400px) and see what happens. Spoiler alert: no surprises here! üéâ

<div class="livedemo demo-container" data-demo-label="">
  <h3>srcset and width: 100%</h3>


  <h4>Without [width][height]</h4>
  <div class="livedemo" data-demo-label="Image > Container" style="width: 150px">
    <img src="./_ignored_yL0QoCVMHj-200.jpeg" srcset="./_ignored_yL0QoCVMHj-200.jpeg 200w, ./_ignored_yL0QoCVMHj-400.jpeg 400w" loading="lazy" decoding="async" alt="The sample Nebula Image from Unsplash on the Eleventy Image docs" class="demo-img-width" sizes="150px" eleventy:ignore>
  </div>

  <div class="livedemo" data-demo-label="Container > Image" style="width: 300px">
    <img src="./_ignored_yL0QoCVMHj-200.jpeg" srcset="./_ignored_yL0QoCVMHj-200.jpeg 200w, ./_ignored_yL0QoCVMHj-400.jpeg 400w" loading="lazy" decoding="async" alt="The sample Nebula Image from Unsplash on the Eleventy Image docs" class="demo-img-width" sizes="300px" eleventy:ignore>
  </div>

  <h4>Using [width][height]</h4>
  <div class="livedemo" data-demo-label="Image > Container" style="width: 150px">
    <img src="./_ignored_yL0QoCVMHj-200.jpeg" srcset="./_ignored_yL0QoCVMHj-200.jpeg 200w, ./_ignored_yL0QoCVMHj-400.jpeg 400w" width="200" height="200" loading="lazy" decoding="async" alt="The sample Nebula Image from Unsplash on the Eleventy Image docs" class="demo-img-width" sizes="150px" eleventy:ignore>
  </div>

  <div class="livedemo" data-demo-label="Container > Image" style="width: 300px">
    <img src="./_ignored_yL0QoCVMHj-200.jpeg" srcset="./_ignored_yL0QoCVMHj-200.jpeg 200w, ./_ignored_yL0QoCVMHj-400.jpeg 400w" width="200" height="200" loading="lazy" decoding="async" alt="The sample Nebula Image from Unsplash on the Eleventy Image docs" class="demo-img-width" sizes="300px" eleventy:ignore>
  </div>
</div>

Keeping our two eligible image widths in play (200px and 400px) let‚Äôs swap to use `max-width: 100%`.

<div class="livedemo demo-container" data-demo-label="">
  <h3>srcset and max-width: 100%</h3>

  <h4>Without [width][height]</h4>
  <div class="livedemo" data-demo-label="Image > Container" style="width: 150px">
  <img src="./_ignored_yL0QoCVMHj-200.jpeg" srcset="./_ignored_yL0QoCVMHj-200.jpeg 200w, ./_ignored_yL0QoCVMHj-400.jpeg 400w" loading="lazy" decoding="async" alt="The sample Nebula Image from Unsplash on the Eleventy Image docs" class="demo-img-maxwidth"  sizes="150px" eleventy:ignore>
  </div>

  <div class="livedemo" data-demo-label="Container > Image" style="width: 300px">
  <img src="./_ignored_yL0QoCVMHj-200.jpeg" srcset="./_ignored_yL0QoCVMHj-200.jpeg 200w, ./_ignored_yL0QoCVMHj-400.jpeg 400w" loading="lazy" decoding="async" alt="The sample Nebula Image from Unsplash on the Eleventy Image docs" class="demo-img-maxwidth"  sizes="300px" eleventy:ignore>
  </div>

  <h4 id="id-srcset-widthheight">Using [width][height]</h4>
  <div class="livedemo" data-demo-label="Image > Container" style="width: 150px">
  <img src="./_ignored_yL0QoCVMHj-200.jpeg" srcset="./_ignored_yL0QoCVMHj-200.jpeg 200w, ./_ignored_yL0QoCVMHj-400.jpeg 400w" width="200" height="200" loading="lazy" decoding="async" alt="The sample Nebula Image from Unsplash on the Eleventy Image docs" class="demo-img-maxwidth" sizes="150px" eleventy:ignore>
  </div>

  <div class="livedemo" data-demo-label="Container > Image" style="width: 300px">
  <img src="./_ignored_yL0QoCVMHj-200.jpeg" srcset="./_ignored_yL0QoCVMHj-200.jpeg 200w, ./_ignored_yL0QoCVMHj-400.jpeg 400w" width="200" height="200" loading="lazy" decoding="async" alt="The sample Nebula Image from Unsplash on the Eleventy Image docs" class="demo-img-maxwidth" sizes="300px" eleventy:ignore>
  </div>
</div>

This is where the rubber finally meets the road. For me, the above test was the most surprising part of the research‚Äîand why a deeper analysis of this perhaps introductory topic was worthwhile (for me).

When I traditionally used `width: 100%` it bulldozed the `[width]` attribute. But a strict `max-width: 100%` now competes with the `[width]` attribute. One solution is to add `width: auto` to pair with our `max-width: 100%` CSS.

_September 9, 2021 Update: [This article has been amended to add one additional caveat about mixing `height: auto` and `width: auto`](#content-layout-shift-addendum)._

That looks like this:

<div class="livedemo demo-container" data-demo-label="" id="srcset-maxwidth-widthauto">
  <h3>srcset and max-width: 100%</h3>

  <h4>Using [width][height] and width: auto ‚ö†Ô∏è incurs CLS costs</h4>
  <div class="livedemo" data-demo-label="Image > Container" style="width: 150px">
  <img src="./_ignored_yL0QoCVMHj-200.jpeg" srcset="./_ignored_yL0QoCVMHj-200.jpeg 200w, ./_ignored_yL0QoCVMHj-400.jpeg 400w" width="400" height="400" loading="lazy" decoding="async" alt="The sample Nebula Image from Unsplash on the Eleventy Image docs" class="demo-img-maxwidth demo-img-widthauto" eleventy:ignore>
  </div>

  <div class="livedemo" data-demo-label="Container > Image" style="width: 300px">
  <img src="./_ignored_yL0QoCVMHj-200.jpeg" srcset="./_ignored_yL0QoCVMHj-200.jpeg 200w, ./_ignored_yL0QoCVMHj-400.jpeg 400w" width="400" height="400" loading="lazy" decoding="async" alt="The sample Nebula Image from Unsplash on the Eleventy Image docs" class="demo-img-maxwidth demo-img-widthauto" eleventy:ignore>
  </div>
</div>

When [Eleventy Image](https://www.11ty.dev/docs/plugins/image/) generates markup for more than one size, the `<img>` element uses the lowest size/quality source. But this behavior has me thinking that when `srcset` is in play it should use the largest dimensions for the `[width]` and `[height]` attributes. I wonder what y‚Äôall think about that? Practically, it would look like this:

<div class="livedemo demo-container" data-demo-label="">
  <h3>srcset and max-width: 100%</h3>

  <h4>Using [width="400"][height="400"]</h4>
  <div class="livedemo" data-demo-label="Image > Container" style="width: 150px">
  <img src="./_ignored_yL0QoCVMHj-200.jpeg" srcset="./_ignored_yL0QoCVMHj-200.jpeg 200w, ./_ignored_yL0QoCVMHj-400.jpeg 400w" width="400" height="400" loading="lazy" decoding="async" alt="The sample Nebula Image from Unsplash on the Eleventy Image docs" class="demo-img-maxwidth" eleventy:ignore>
  </div>

  <div class="livedemo" data-demo-label="Container > Image" style="width: 300px">
  <img src="./_ignored_yL0QoCVMHj-200.jpeg" srcset="./_ignored_yL0QoCVMHj-200.jpeg 200w, ./_ignored_yL0QoCVMHj-400.jpeg 400w" width="400" height="400" loading="lazy" decoding="async" alt="The sample Nebula Image from Unsplash on the Eleventy Image docs" class="demo-img-maxwidth" eleventy:ignore>
  </div>
</div>

This makes `max-width: 100%` a bit more predictable, as the rendered size now matches the behavior when `[width][height]` are not included or when `width: auto` was left off. The maximum width now correctly matches the intrinsic width of the largest image in our `srcset` list.

_February 24, 2021 Update: [Eleventy Image v0.8.0](https://github.com/11ty/eleventy-img/milestone/9?closed=1) was released with the [above `[width][height]` attribute optimization](https://github.com/11ty/eleventy-img/issues/63)._

~~Again‚Äîpractically I would recommend to pair `max-width: 100%` with `width: auto` to fix this in the easiest way but this _might_ help avoid some confusion for some folks that aren‚Äôt aware of this.~~

_September 9, 2021 Update: [This article has been amended to add one caveat about mixing `height: auto` and `width: auto`](#content-layout-shift-addendum)._


## Conclusions (aka TL;DR)

* All of these approaches operate the same when the container is smaller than the image.
* Using `width: 100%` can give you some blurry images if you‚Äôre not careful with your container sizes (without Content Layout Shift penalties).
* Using `max-width: 100%` constrains the image to the container, but be careful when you use this with `srcset`‚Äîit may cap smaller than you want when using `[width]`! Use the largest `[width]` and `[height]` attributes to fix this.
* ‚ö†Ô∏è Do not use `width: auto` paired with `height: auto` as this can [incur Content Layout Shift penalties](#content-layout-shift-addendum).
* But perhaps esoterically I‚Äôm walking away with this remaining question: when you have multiple image sizes listed in a `srcset` list, which dimensions do you use for the `[width]` and `[height]` attributes? I kinda want to use the largest one‚Äîany obvious downsides to that?

_February 24, 2021 Update: [Eleventy Image v0.8.0](https://github.com/11ty/eleventy-img/milestone/9?closed=1) was released to use the [largest size for the `[width][height]` attributes](https://github.com/11ty/eleventy-img/issues/63)._

### Copy and Paste

Writing this blog post has swayed me to part from my `width: 100%` ways! I think this is what my boilerplate will be moving forward:

```css
img {
  max-width: 100%;
}
img[width][height] {
  height: auto; /* Preserve aspect ratio */
}
/* Let SVG scale without boundaries */
img[src$=".svg"] {
  width: 100%;
  height: auto;
  max-width: none;
}
```

_February 24, 2021 Update: [Chris Coyier posted a great follow up to this post on CSS Tricks](https://css-tricks.com/barebones-css-for-fluid-images/) with some super valuable extra information about how `srcset` affects rendered image dimensions._

## Content Layout Shift Addendum

_September 9, 2021 Update:_ Prior versions of this blog post recommended `img[width] { width: auto; }` to solve the problem of images rendering too small when [the `width` and `height` attributes were smaller than the maximum intrinsic size supplied via the `srcset` attribute](#id-srcset-widthheight). The best fix here is to use the largest dimensions for your `width` and `height` attributes (even if you use a lower quality version for the `src`).

Additionally, [{% twitterImageAvatar "radumicu" %}radumicu](https://twitter.com/radumicu/status/1435880463076413440) kindly pointed out that using `width: auto` in this way conflicts with the default styles for `aspect-ratio` and incurs Content Layout Shift penalties.

I tested and confirmed this to be true when you pair `width: auto` and `height: auto` together. You can view the tests on Codepen:

* ‚úÖ [`<img>` with `{ max-width: 100% }`](https://codepen.io/zachleat/pen/QWgpMvg) no CLS penalties
* ‚úÖ [`<img>` with `{ max-width: 100%; width: auto }`](https://codepen.io/zachleat/pen/ExXWQPq) no CLS penalties
* ‚úÖ [`<img>` with `{ max-width: 100%; height: auto }`](https://codepen.io/zachleat/pen/powedpy) no CLS penalties
* ‚ùå [`<img>` with `{ max-width: 100%; width: auto; height: auto }`](https://codepen.io/zachleat/pen/zYzZZLe) console logs CLS penalties.
* ‚úÖ [`<img>` with `{ width: 100%; height: auto }`](https://codepen.io/zachleat/pen/LYLWOQm) no CLS penalties
